<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=33309&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Quarto | renauxv</title>
<meta name="keywords" content="Raylib, C, Optimisation">
<meta name="description" content="Dans le cadre d’un projet universitaire, nous étions invités à développer une version numérique du jeu de plateau Quarto. Aux côtés de mon collègue E. HADDAG, nous avons ainsi tenté de concevoir l’implémentation la plus performante à notre portée de ce jeu. L&rsquo;intégralité
de ce projet a été réalisée en C de l&rsquo;interface à la mise en place du modèle.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:33309/posts/quarto/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:33309/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:33309/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:33309/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:33309/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:33309/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:33309/posts/quarto/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:33309/" accesskey="h" title="renauxv (Alt + H)">renauxv</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:33309/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:33309/notes" title="Notes">
                    <span>Notes</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:33309/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:33309/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:33309/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:33309/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Quarto
    </h1>
    <div class="post-meta"><span title='2025-04-28 00:00:00 +0000 UTC'>April 28, 2025</span>&nbsp;·&nbsp;<span>10 min</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul>
                <li>
                    <a href="#sommaire" aria-label="Sommaire">Sommaire</a></li></ul>
                    
                <li>
                    <a href="#r%c3%a8gles" aria-label="Règles">Règles</a><ul>
                        
                <li>
                    <a href="#extension-du-jeu" aria-label="Extension du jeu">Extension du jeu</a></li></ul>
                </li>
                <li>
                    <a href="#impl%c3%a9mentation" aria-label="Implémentation">Implémentation</a><ul>
                        
                <li>
                    <a href="#repr%c3%a9sentation-dune-partie-de-jeu" aria-label="Représentation d&rsquo;une partie de jeu">Représentation d&rsquo;une partie de jeu</a><ul>
                        
                <li>
                    <a href="#les-pi%c3%a8ces" aria-label="Les pièces">Les pièces</a></li>
                <li>
                    <a href="#le-plateau" aria-label="Le plateau">Le plateau</a></li>
                <li>
                    <a href="#l%c3%a9tat-du-jeu" aria-label="L&rsquo;état du jeu">L&rsquo;état du jeu</a></li></ul>
                </li>
                <li>
                    <a href="#r%c3%a9cup%c3%a9ration-des-informations" aria-label="Récupération des informations">Récupération des informations</a></li>
                <li>
                    <a href="#%c3%a9criture-des-informations" aria-label="Écriture des informations">Écriture des informations</a><ul>
                        
                <li>
                    <a href="#description-des-types" aria-label="Description des types">Description des types</a></li>
                <li>
                    <a href="#v%c3%a9rifications-de-fin-de-partie" aria-label="Vérifications de fin de partie">Vérifications de fin de partie</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#interface" aria-label="Interface">Interface</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Dans le cadre d’un projet universitaire, nous étions invités à développer une version numérique du jeu de plateau <em>Quarto</em>. Aux côtés de mon collègue <a href="https://sagbot.com/">E. HADDAG</a>, nous avons ainsi tenté de concevoir l’implémentation la plus performante à notre portée de ce jeu. L&rsquo;intégralité
de ce projet a été réalisée en <em>C</em> de l&rsquo;interface à la mise en place du modèle.</p>
<h2 id="sommaire">Sommaire<a hidden class="anchor" aria-hidden="true" href="#sommaire">#</a></h2>
<p>Cet article se composera en trois parties :</p>
<ol>
<li><a href="#r%C3%A8gles">L&rsquo;explication des règles du jeu.</a></li>
<li><a href="#impl%C3%A9mentation">Une présentation de l&rsquo;implémentation de celui-ci.</a></li>
<li><a href="#Interface">La mise en place de l’interface graphique à l’aide de la librairie <em>C</em>,
<em>Raylib</em>.</a></li>
</ol>
<hr>
<h1 id="règles">Règles<a hidden class="anchor" aria-hidden="true" href="#règles">#</a></h1>
<p>Le jeu du <em>Quarto</em> se joue à deux joueurs sur un plateau <strong>4×4</strong>. Les deux
joueurs ont à disposition <strong>16 pièces</strong>, toutes différentes. Chacune de ces
pièces dispose de quatre caractéristiques dont les valeurs possibles sont les
suivantes :</p>
<ul>
<li><strong>Couleur</strong> : Rouge ou Bleu,</li>
<li><strong>Forme</strong> : Cylindrique ou Cubique,</li>
<li><strong>Taille</strong> : Grande ou Petite,</li>
<li><strong>Type</strong> : Pleine ou Creuse.</li>
</ul>
<p>Les <strong>16 pièces</strong> sont donc toutes les combinaisons possibles de ces
caractéristiques. L&rsquo;image ci-dessous nous donne une représentation de ces
pièces.</p>
<p><img alt="Images des <strong>16 pièces</strong> du <em>Quarto</em>" loading="lazy" src="https://i.imgur.com/bzjqcgQ.png">
<em>Image provenant d&rsquo;un <a href="https://math.univ-lyon1.fr/irem/IMG/pdf/Quarto.pdf">document Universitaire sur le <em>Quarto</em></a>.</em></p>
<p>Une partie de jeu se déroule de la façon suivante :</p>
<ol>
<li>Le joueur <em>Max</em> choisit une pièce qu&rsquo;il offre à son adversaire.</li>
<li>Le joueur <em>Min</em> place cette pièce sur le plateau et donne une seconde pièce dans celles restantes à <em>Max</em>.</li>
<li><em>Max</em> réitaire les opérations de <em>Min</em>.</li>
</ol>
<p>La partie se termine lorsque l&rsquo;un des deux joueurs réussit à aligner quatre
pièces comportant une <strong>caractéristique commune</strong>. La façon dont ont peu
aligner les pièces sont celles données par l&rsquo;image :</p>
<p><img alt="Configuration gagnante dans le jeu." loading="lazy" src="https://i.imgur.com/1tdnuC5.png">
<em>Exemple de configurations gagnantes.</em></p>
<p>Le joueur gagnant est celui qui pose la pièce qui amène à cet alignement.
Cependant, il existe des configurations dans lesquelles aucun des deux joueurs
n&rsquo;est gagnant.</p>
<p>La configuration suivante ne permet à aucun des deux joueurs de réclamer la
victoire :</p>
<p><img alt="Exemple de configuration <em>nulle</em>" loading="lazy" src="https://i.imgur.com/boXg7nC.png#center">
<em>Exemple de configuration <em>nulle</em> (aucun des deux joueurs ne gagne la partie).</em></p>
<h2 id="extension-du-jeu">Extension du jeu<a hidden class="anchor" aria-hidden="true" href="#extension-du-jeu">#</a></h2>
<p>Il a été prouvé par <em>Luc Goossens</em> sur <a href="https://web.archive.org/web/20041012023358/http://ssel.vub.ac.be/Members/LucGoossens/quarto/quartotext.htm">son site</a> que le jeu du <em>Quarto</em> est un jeu <em>nulle</em>. C&rsquo;est-à-dire que si les deux joueurs jouent à chaque fois les <em>meilleurs</em> couts, aucun des deux ne peut gagner.</p>
<p>Pour contrer ce problème, nous mettons en place une version du <em>Quarto</em> à
quatre niveaux de jeu :</p>
<p><strong>Niveau 1</strong> : configuration gagnante : celle classique. L&rsquo;alignement de quatre pièces possédant une caractéristique commune.</p>
<!-- raw HTML omitted -->
<p><em>Exemple de partie gagnée dans le <strong>niveau 1</strong>. La couleur est la caractéristique commune.</em></p>
<p><strong>Niveau 2</strong> : configurations gagnantes : celle du niveau 1 ainsi qu&rsquo;une disposition de quatre pièces aillant une caractéristique en commun dans un carré de largueur 2.</p>
<!-- raw HTML omitted -->
<p><em>Exemple de partie gagnée dans le <strong>niveau 2</strong>. Le type (creuse) des quatre pièces est la caractéristique commune.</em></p>
<p><strong>Niveau 3</strong> : configurations gagnantes : celles des niveaux précédents ainsi que la disposition de quatre pièces (toujours avec une caractéristique commune) dans les coins d&rsquo;un carré de largueur 3.</p>
<!-- raw HTML omitted -->
<p><em>Exemple de partie gagnée dans le <strong>niveau 3</strong>. La hauteur (grande) des quatre pièces est la caractéristique commune.</em></p>
<p><strong>Niveau 4</strong> : configurations gagnantes : celles des niveaux précédents, ainsi que quatre pièces (toujours avec une caractéristique commune) formant soit un losange de largueur deux ou qu&rsquo;elles soient dans les coins d&rsquo;un losange de largueur 3.</p>
<!-- raw HTML omitted -->
<p><em>Exemple de deux parties gagnées dans le <strong>niveau 4</strong>. Que ce soit par la condition des coins ou encore du losange de largueur 3.</em></p>
<hr>
<h1 id="implémentation">Implémentation<a hidden class="anchor" aria-hidden="true" href="#implémentation">#</a></h1>
<p>Tout le code associé à l&rsquo;implémentation de la logique du jeu (et en aucun cas de l&rsquo;interface) est décrit dans cette partie. L&rsquo;intégralité de ce code est disponible sur le <em>Github</em> <a href="https://github.com/titusse3/quarto">quarto</a>.</p>
<h2 id="représentation-dune-partie-de-jeu">Représentation d&rsquo;une partie de jeu<a hidden class="anchor" aria-hidden="true" href="#représentation-dune-partie-de-jeu">#</a></h2>
<p>L&rsquo;objectif de cette implémentation est d&rsquo;être performante quant à son
d&rsquo;utilisation mémoires.&quot;
Cette contrainte est due à l&rsquo;objectif d&rsquo;utiliser cette implémentation par des algorithmes d&rsquo;optimisation et de prise de décision dans un jeu. (MinMax, NégaMax &hellip;).</p>
<h3 id="les-pièces">Les pièces<a hidden class="anchor" aria-hidden="true" href="#les-pièces">#</a></h3>
<p>Il y a <strong>16 pièces</strong> dans ce jeu, chacune à <strong>quatre attributs</strong> ne pouvant prendre que deux valeurs. Nous avons donc décidé de représenter une pièce par un ensemble de 4 bit. Chaque bit représente une des quatre conditions suivantes :</p>
<ul>
<li>Est-ce que la pièce est marron ?</li>
<li>Est-ce que la pièce est grande ?</li>
<li>Est-ce que la pièce est creuse ?</li>
<li>Est-ce que la pièce est un cube ?</li>
</ul>
<p>Si la condition est vérifiée, alors le bit vaut <em>1</em>, <em>0</em> dans le cas contraire. Un exemple de telle représentation est donné par l&rsquo;image ci-dessous :</p>
<!-- raw HTML omitted -->
<p><em>Représentation de la petite pièce cylindrique marron qui est creuse selon notre représentation sur 4 bits.</em></p>
<h3 id="le-plateau">Le plateau<a hidden class="anchor" aria-hidden="true" href="#le-plateau">#</a></h3>
<p>Sur un plateau de <em>Quarto</em>, il y a <strong>16 cases</strong>. De plus, nous avons déjà une
représentation des pièces sur 4 bits. Nous allons donc utiliser un entier de
64 bits (\(16 \times 4 = 64\)) où chaque bloc de 4 bits représentera une case
de notre plateau de jeu. La première case sera la plus à gauche tandis que la
dernière sera à droite.</p>
<p><img alt="Représentation du plateau de jeu sur 64 bits" loading="lazy" src="https://i.imgur.com/Nm6wh1h.png">
<em>Chaque case présente sur ce schéma est un groupe de 4 bits représentant une pièce.</em></p>
<p>Avec cette implémentation, on se heurte à un problème. On ne peut pas
représenter sur notre plateau l&rsquo;absence de pièces sur une case. En effet,
chaque combinaison possible sur les 4 bits est associée à une pièce.
Pour résoudre ce problème, nous ajoutons donc un <em>résumé</em> de 16 bits. Chaque
bit de ce <em>résumé</em> décrit la vacuité de la case de même indice.</p>
<p><img alt="Exemple d&rsquo;un résumer de plateau." loading="lazy" src="https://i.imgur.com/ioZlRkB.png">
<em>Par exemple, se résume à écrire un plateau qui n&rsquo;admet des pièces qu&rsquo;aux cases
d&rsquo;indice 1, 3, 7 et 10.</em></p>
<h3 id="létat-du-jeu">L&rsquo;état du jeu<a hidden class="anchor" aria-hidden="true" href="#létat-du-jeu">#</a></h3>
<p>Maintenant qu&rsquo;on sait représenter les pièces et le plateau de jeu, il nous faut
enregistrer quelques informations supplémentaires :</p>
<ul>
<li>Est-ce que la partie est finie ? 1 si oui, 0 sinon.</li>
<li>À qui est-ce le tour ? 0 pour <em>Max</em> et 1 pour <em>Min</em>.</li>
<li>Quelle pièce le joueur doit-il placer ? Descriptions de la pièce (toujours sur 4 bits).</li>
<li>À quel tour sommes-nous ? nombre en 0 et 16 sur 5 bits.</li>
<li>Sur quel niveau de difficulté le jeu se joue-t-il ? Sur deux bits</li>
<li>00 : niveau 1</li>
<li>01 : niveau 2</li>
<li>10 : niveau 3</li>
<li>11 : niveau 4</li>
</ul>
<p>Pour cela, nous allons rajouter \(1 + 1 + 4 + 5 + 2 = 13\) bits. Nous obtenons
donc comme représentation de ces informations de la manière suivante :</p>
<p><img alt="Représentation de l&rsquo;état de jeu sur 13 bits." loading="lazy" src="https://i.imgur.com/fREsn5L.png"></p>
<p>Ce qui nous donne une représentation finale :</p>
<p><img alt="Représentation complète d&rsquo;une partie de <em>Quarto</em>" loading="lazy" src="https://i.imgur.com/Fz0k9OT.png#center"></p>
<p>Que nous représentons alors avec la structure suivante en <em>C</em> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> <span style="color:#66d9ef">quarto_t</span> {
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">uint32_t</span> summary;
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">uint64_t</span> board;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="récupération-des-informations">Récupération des informations<a hidden class="anchor" aria-hidden="true" href="#récupération-des-informations">#</a></h2>
<p>Pour interagir avec notre représentation, nous devons de ce faite utiliser les
opérateurs bit à bit fournis par le <em>C</em> :</p>
<table>
  <thead>
      <tr>
          <th>Opérateur</th>
          <th>Descriptions</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>~</code></td>
          <td>Opération de négation d&rsquo;un nombre binaire.</td>
      </tr>
      <tr>
          <td><code>&amp;</code></td>
          <td>Et logique.</td>
      </tr>
      <tr>
          <td><code>|</code></td>
          <td>Ou logique.</td>
      </tr>
      <tr>
          <td><code>^</code></td>
          <td>Ou exclusif (<em>xor</em>)</td>
      </tr>
  </tbody>
</table>
<p>Nous allons parfois avoir besoin de la valeur d&rsquo;un bit à une certaine position.
Notamment pour récupérer les valeurs dans le résumé. Prenons, par exemple, le
cas où nous voudrions récupérer le bit de la case 15 de notre <em>résumé</em>.</p>
<p><img alt="Mise en évidence du bit rerpésentant la case 15 de notre plateau" loading="lazy" src="https://i.imgur.com/yfEkXAd.png"></p>
<p>Sur les schémas depuis le début, nous avons représenté nos indices de la gauche
vers la droite, or en informatique, les nombres se lisent de la droite vers la
gauche. Ce qui implique que le bit d&rsquo;indice 31 dans notre dessin correspond en
réalité au bit d&rsquo;indice 0. On aura donc que l&rsquo;opération</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%b&#34;</span>, quarto.summary <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>);
</span></span></code></pre></div><p>nous renvoie le bit d&rsquo;indice 31 sur notre dessin.</p>
<p>Pour accéder à la valeur du bit recherché, il faut ainsi décaler (<em>shift</em>) cette
case le plus à droite possible. Après cela, il suffit d&rsquo;appliquer un et logique
à ce bit et 1.</p>
<p>Il faut aussi se rappeler qu&rsquo;en informatique, les nombres se lisent de droite à
gauche. Ainsi, pour récupérer le bit le plus à gauche, on devra faire plusieurs
décalages (<em>shift</em>) de sens pour amener le bit à droite de la même manière que
l&rsquo;animation ci-dessous.</p>
<p><img alt="<em>Gif</em> d&rsquo;exemple de shift de façon récuprer une valeur à un certain indice" loading="lazy" src="https://i.imgur.com/NpIoUUf.gif"></p>
<p>Pour rappel, les décalage en <em>C</em> se font dans les deux sens par les opérateurs suivants :</p>
<table>
  <thead>
      <tr>
          <th>Opérteur</th>
          <th>Descriptions</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>a &gt;&gt; b</code></td>
          <td>Décale les bits de <code>a</code> de <code>b</code> case vers la droite.</td>
      </tr>
      <tr>
          <td><code>a &lt;&lt; b</code></td>
          <td>Décale les bits de <code>a</code> de <code>b</code> case vers la gauche.</td>
      </tr>
  </tbody>
</table>
<p>Selon la norme
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->C23<!-- raw HTML omitted -->
<!-- raw HTML omitted -->, les bits ajoutés que ce soit à gauche ou à droite sont des zéros (outre
le cas où le décalage est plus grand que la longueur du mot binaire)</p>
<h2 id="écriture-des-informations">Écriture des informations<a hidden class="anchor" aria-hidden="true" href="#écriture-des-informations">#</a></h2>
<h3 id="description-des-types">Description des types<a hidden class="anchor" aria-hidden="true" href="#description-des-types">#</a></h3>
<p>Pour simplifier les écritures de positionnement d&rsquo;une pièce sur une certaine
case, nous avons donné à l&rsquo;énumération <code>piece_t</code> et <code>position_t</code> des valeurs
particulières.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">enum</span> {
</span></span><span style="display:flex;"><span> <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> C1_HUGE_HOLE_SQUARE <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b0110<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0110</span>,
</span></span><span style="display:flex;"><span> <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">piece_t</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">enum</span> {
</span></span><span style="display:flex;"><span> <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> P3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>b0000<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1111</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0000</span>,
</span></span><span style="display:flex;"><span> <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">position_t</span>;
</span></span></code></pre></div><p>Les notations <code>0b</code> ainsi que les caractères <code>'</code> dans la notation. Les
binaires sont tous deux issus de la <em>C23</em>. La première permet d&rsquo;écrire la valeur
au format binaire. La seconde correspond simplement à un séparateur améliorant
la lisibilité.</p>
<p>L&rsquo;objectif étant de mettre en place une écriture/lecture d&rsquo;une position du
plateau de manière très rapide. Pour ce faire, on représente les positions
(<code>position_t</code>) sur 64 bits. Pour qu&rsquo;il soit de la même taille que le plateau.
Ces bits sont tous à zéro seul le mot de quatre bits qui correspond à la case en
question admet ces bits à un.</p>
<p>De cette manière, pour récupérer la valeur de la pièce à la position 3 par
exemple, il nous suffit de faire l&rsquo;opération :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>quarto.board <span style="color:#f92672">&amp;</span> P3;
</span></span></code></pre></div><p>De même pour l&rsquo;écriture, il nous suffira d&rsquo;effectuer l&rsquo;opération :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>quarto.board <span style="color:#f92672">|=</span> C1_HUGE_HOLE_SQUARE <span style="color:#f92672">&amp;</span> P3;
</span></span></code></pre></div><p>La raison pour laquelle l&rsquo;écriture est si simple et que nous avons mis décris
le type <code>piece_t</code> comme une répétition de la valeur de pièce sur 64 bits.
Pour qu&rsquo;un simple et logique permette de modifier la valeur à cette case.</p>
<h3 id="vérifications-de-fin-de-partie">Vérifications de fin de partie<a hidden class="anchor" aria-hidden="true" href="#vérifications-de-fin-de-partie">#</a></h3>
<p>Nous n&rsquo;allons pas détailler toutes les fonctions permettant de vérifier chaque
condition de victoires selon les niveaux. En effet, une même logique est
appliquée dans chacune de ces fonctions (de nom <code>check__*</code>) ; seul le parcours
du plateau est différent.</p>
<p>Pour ce faire, on suppose que les quatre pièces que l&rsquo;on souhaite tester sont
<code>[p1, p2, p3, p4]</code>. On commence par initialiser un accumulateur qui représentera
à chaque étape les points communs entre chaque pièce déjà traitée. Cet
accumulateur a donc la description suivante :</p>
<p><img alt="Description de l&rsquo;accumulateur." loading="lazy" src="https://i.imgur.com/kHRrICg.png">
<em>Exemple et description de l&rsquo;accumulateur. Ici, les propriétés communes sont la
taille et la forme.</em></p>
<p>Maintenant, pour calculer les points communs entre deux pièces, il faut obtenir
les bits correspondant aux mêmes caractéristiques. On ne peut pas simplement
utiliser un et logique, par exemple, si nos deux pièces sont jaunes, leur
premier bit vaut toutes deux 0. Or, avec le et logique, nous aurions 0. Nous
avons donc besoin d&rsquo;un opérateur aillant pour la table de vérité :</p>
<table>
  <thead>
      <tr>
          <th>a</th>
          <th>b</th>
          <th>Résultat</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0</td>
          <td>0</td>
          <td>1</td>
      </tr>
      <tr>
          <td>0</td>
          <td>1</td>
          <td>0</td>
      </tr>
      <tr>
          <td>1</td>
          <td>0</td>
          <td>0</td>
      </tr>
      <tr>
          <td>1</td>
          <td>1</td>
          <td>1</td>
      </tr>
  </tbody>
</table>
<p>Par ailleurs, on peut implémenter cette table par la formule <code>~(a ^ b)</code> (il
s&rsquo;agit de l&rsquo;inverse d&rsquo;un <em>ou exclusif</em>) en <em>C</em>. Il nous suffira alors
d&rsquo;effectuer un et logique entre cette valeur et la valeur actuelle de notre
accumulateur.</p>
<p>À la fin de ces calculs, il nous suffit de regarder la valeur de l&rsquo;accumulateur.
S&rsquo;il vaut 0, il n&rsquo;y a donc aucun point commun, sinon la partie est gagnée.</p>
<p>Comme évoqué précédemment, toutes les fonctions de tests utilisent ce procédé,
seuls les algorithmes permettant de récupérer les pièces à comparer changent.</p>
<h1 id="interface">Interface<a hidden class="anchor" aria-hidden="true" href="#interface">#</a></h1>
<p>Tout d&rsquo;abord, le fond du jeu utilise le module <code>mbck</code> présenté dans l&rsquo;article
&ldquo;parallaxe_raylib&rdquo;. Nous ne rentrerons pas dans les détails de
l&rsquo;implémentation <em>Raylib</em>. Il s&rsquo;agit du premier gros projet que nous mettons en
place avec celle-ci. De ce fait, le code a une qualité qui permet d&rsquo;être
instructif.</p>
<p>Cette partie sert à faire une démonstration des fonctionnalités du jeu. Une
image vaut mieux que mille mots, voici une vidéo qui démontre une partie des
fonctionnalités disponibles. Si vous avez des retours sur ce jeu, merci de nous
contacter.</p>
<!-- raw HTML omitted -->

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:33309/tags/raylib/">Raylib</a></li>
      <li><a href="http://localhost:33309/tags/c/">C</a></li>
      <li><a href="http://localhost:33309/tags/optimisation/">Optimisation</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:33309/posts/rag_definition/">
    <span class="title">« Prev</span>
    <br>
    <span>Génération Augmentée de récupération (RAG)</span>
  </a>
  <a class="next" href="http://localhost:33309/posts/parallaxe_raylib/">
    <span class="title">Next »</span>
    <br>
    <span>Fond Parallaxe</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>Renaux Verdiere Theo</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
